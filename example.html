<title>Websocket Shell Example</title>
<style>
	html, body {
		padding: 0px;
		margin: 0px;
	}
  main {
  	position: fixed;
    width: 100vw;
    height: 100vh;
  }
</style>
<main></main>
<style>
	@import url("//unpkg.com/xterm@4/css/xterm.css");
</style>
<script src="//unpkg.com/xterm@4/lib/xterm.js"></script>
<script src="//unpkg.com/xterm-addon-fit/lib/xterm-addon-fit.js"></script>
<script>
const term = new Terminal()
const fitAddon = new FitAddon.FitAddon()
term.loadAddon(fitAddon)
const terminalElement = document.querySelector('main')
term.open(terminalElement)
fitAddon.fit()

const socket = new WebSocket('ws://crapheap:8080/')

// Listen on data, write it to the terminal
socket.onmessage = ({data}) => {
  term.write(data)
}

socket.onclose = () => {
  term.write('\r\nConnection closed.\r\n')
}

// Listen on user input, send it to the connection
term.onData((data) => {
	console.log(data)
  socket.send(data)
})

document.querySelector('textarea').addEventListener('keydown', console.log)

//term.on('key', (key, event) => {
	//console.log('key', key, event)
// })
</script>
